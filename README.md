##  üöÄ –ò–¥–µ—è –ø—Ä–æ–µ–∫—Ç–∞: "URL Shortener Service"
###  –≠—Ç–æ –ø—Ä–∏–º–µ—Ä - –ø—Ä–æ—Å—Ç–æ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—á–µ–Ω—å –Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º. 

### –ß—Ç–æ –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å:
- –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –¥–ª–∏–Ω–Ω—ã—Ö URL
- –†–µ–¥–∏—Ä–µ–∫—Ç –ø–æ –∫–æ—Ä–æ—Ç–∫–∏–º —Å—Å—ã–ª–∫–∞–º
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
- TTL –¥–ª—è —Å—Å—ã–ª–æ–∫ (–∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö)

### üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫:
- Kotlin + Spring Boot 3
- Gradle (Kotlin DSL)
- PostgreSQL - –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- Redis - –∫—ç—à –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤
- Kafka - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- Docker + Docker Compose - –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### üéØ –ß—Ç–æ –º—ã –ø–æ–ª—É—á–∏–º:
- PostgreSQL - –Ω–∞–¥–µ–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- Redis - –±—ã—Å—Ç—Ä—ã–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã (—Ç—ã—Å—è—á–∏ RPS)
- Kafka - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- Docker - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- Kotlin + Gradle - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### üîç –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫ –º–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î, –ö–∞—Ñ–∫–æ–π, –†–µ–¥–∏—Å–æ–º:
- `Spring Boot` —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –Ω–∞—á–∏–Ω–∞—è –æ—Ç –ø–∞–∫–µ—Ç–∞ –≥–ª–∞–≤–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞
- `@Component` –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç –∫–ª–∞—Å—Å –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏
- `ApplicationRunner` –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –í–∞—Ä–∏–∞–Ω—Ç —Å ApplicationRunner –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ Spring


### –ú–µ—Ö–∞–Ω–∏–∑–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –≤ JPA/Hibernate

### üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### **1. –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è @GeneratedValue**

–í –≤–∞—à–µ–π —Å—É—â–Ω–æ—Å—Ç–∏ `ShortUrl`:

```kotlin
@Entity
@Table(name = "short_urls")
data class ShortUrl(
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)  // ‚Üê –í–æ—Ç —ç—Ç–æ –∫–ª—é—á–µ–≤–∞—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è!
    val id: Long = 0,
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
)
```

### **2. –°—Ç—Ä–∞—Ç–µ–≥–∏—è GenerationType.IDENTITY**

`GenerationType.IDENTITY` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–∞–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ ID —á–µ—Ä–µ–∑ **auto-increment** –º–µ—Ö–∞–Ω–∏–∑–º.

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ PostgreSQL:**
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü—ã Hibernate –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç —Å—Ç–æ–ª–±–µ—Ü —Å `SERIAL` –∏–ª–∏ `BIGSERIAL` —Ç–∏–ø–æ–º
- PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **sequence** (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å) –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —á–∏—Å–µ–ª
- –ö–∞–∂–¥–∞—è –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å –ø–æ–ª—É—á–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ `nextval('sequence_name')`

### **3. –ú–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—É—é sequence:**

–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –ë–î –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```sql
-- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å sequences –≤ –≤–∞—à–µ–π –ë–î
SELECT sequence_name FROM information_schema.sequences 
WHERE sequence_name LIKE '%short_urls%';

-- –û–±—ã—á–Ω–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è sequence —Å –∏–º–µ–Ω–µ–º: short_urls_id_seq
-- –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ sequence
SELECT nextval('short_urls_id_seq');
```

## üéØ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ID:

### **A. GenerationType.SEQUENCE (–¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)**
```kotlin
@Id
@GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "short_url_seq")
@SequenceGenerator(name = "short_url_seq", sequenceName = "short_url_id_seq", allocationSize = 1)
val id: Long = 0
```

### **B. GenerationType.TABLE (–º–µ–Ω–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ)**
```kotlin
@Id
@GeneratedValue(strategy = GenerationType.TABLE, generator = "short_url_generator")
@TableGenerator(name = "short_url_generator", table = "id_generator", pkColumnName = "entity_name", valueColumnName = "next_id")
val id: Long = 0
```

### **C. UUID (–¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º)**
```kotlin
@Id
@GeneratedValue(generator = "UUID")
@GenericGenerator(name = "UUID", strategy = "org.hibernate.id.UUIDGenerator")
val id: UUID? = null
```

## üîç **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏:**

```kotlin
// 1. –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –ë–ï–ó ID (id = 0)
val shortUrl = ShortUrl(
    shortCode = "abc123", 
    originalUrl = "https://example.com"
)

// 2. –°–æ—Ö—Ä–∞–Ω—è–µ–º
val savedUrl = shortUrlRepository.save(shortUrl)

// 3. Hibernate –≤—ã–ø–æ–ª–Ω—è–µ—Ç:
//    - INSERT INTO short_urls (short_code, original_url, ...) 
//      VALUES ('abc123', 'https://example.com', ...)
//    - PostgreSQL –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ID
//    - Hibernate —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —ç—Ç–æ—Ç ID –≤ –æ–±—ä–µ–∫—Ç

println(savedUrl.id) // ‚Üí 1, 2, 3, ... (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```

## üí° **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ IDENTITY —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:**

- **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î
- **–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å** - –¥–∞–∂–µ –≤ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–π —Å—Ä–µ–¥–µ
- **–ü–æ—Ä—è–¥–æ–∫ —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è** - ID –≤—Å–µ–≥–¥–∞ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç—Å—è –Ω–∞ 1

## ‚ö†Ô∏è **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã:**

- **–ù–µ batch-able** - –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç–Ω—É—é –≤—Å—Ç–∞–≤–∫—É
- **ID –∏–∑–≤–µ—Å—Ç–µ–Ω —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∫–æ–º–º–∏—Ç–∞** - –ø—Ä–∏ –æ—Ç–∫–∞—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ ID –º–æ–∂–µ—Ç "–ø—Ä–æ–ø–∞—Å—Ç—å"
- **–î–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º** –∏–Ω–æ–≥–¥–∞ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å UUID –∏–ª–∏ sequence —Å allocationSize

## üöÄ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ:**

–í—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø—Ä–æ—Ü–µ—Å—Å:

```kotlin
@Service
class UrlShorteningService(
    private val shortUrlRepository: ShortUrlRepository
) {
    
    fun createShortUrl(originalUrl: String): ShortUrl {
        val shortUrl = ShortUrl(
            shortCode = generateShortCode(),
            originalUrl = originalUrl
        )
        
        println("üìù Before save - ID: ${shortUrl.id}") // ‚Üí 0
        
        val savedUrl = shortUrlRepository.save(shortUrl)
        
        println("üíæ After save - ID: ${savedUrl.id}") // ‚Üí 1, 2, 3, ...
        
        return savedUrl
    }
}
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏ –Ω–∞–¥–µ–∂–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º**, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–±–∞–≤–ª—è–µ—Ç –Ω–∞—Å –æ—Ç —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º–∏!

---